(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3496:(e,t,a)=>{Promise.resolve().then(a.bind(a,8899))},3775:(e,t,a)=>{"use strict";a.d(t,{LanguageProvider:()=>n,o:()=>d});var r=a(5155),s=a(2115);let l=(0,s.createContext)(void 0),i={es:{"header.title":"\uD83C\uDFAF Generador de Tarjetas QSL","header.subtitle":"Crea tarjetas QSL profesionales con imagen de fondo personalizada y tabla editable","header.createdBy":"Creado por","instructions.title":"\uD83D\uDCCB C\xf3mo usar","instructions.step1":"Sube una imagen de alta calidad como fondo para tu tarjeta QSL","instructions.step2":"Personaliza los colores y el idioma de la tabla QSL seg\xfan tus preferencias","instructions.step3":"Ve la vista previa en tiempo real de tu tarjeta QSL personalizada","instructions.step4":"Descarga tu tarjeta QSL en alta resoluci\xf3n lista para imprimir","tech.title":"⚙️ Especificaciones T\xe9cnicas","tech.resolution":"Resoluci\xf3n final:","tech.format":"Formato est\xe1ndar:","tech.inputFormats":"Formatos de entrada:","tech.maxSize":"Tama\xf1o m\xe1ximo:","tech.table":"Tabla QSL:","tech.processing":"Procesamiento:","tech.privacy":"\uD83D\uDD12 Privacidad garantizada: Todas las im\xe1genes se procesan localmente en tu navegador, sin env\xedo de datos a servidores externos.","tech.dynamicGenerated":"Generada din\xe1micamente","tech.localProcessing":"100% local en tu navegador","tech.localHint":"✅ 100% procesamiento local - Tus im\xe1genes nunca salen de tu navegador","steps.image":"Imagen","steps.table":"Tabla QSL","steps.preview":"Vista previa","steps.download":"Descarga","steps.current":"Paso actual:","steps.next":"Siguiente:","step1.title":"Sube tu imagen de fondo","step2.title":"Personaliza la tabla QSL","step3.title":"Vista previa de la tarjeta","step4.title":"Descargar tarjeta QSL","uploader.dragActive":"Suelta la imagen aqu\xed","uploader.dragInactive":"Sube tu imagen de fondo","uploader.subtitle":"Arrastra y suelta, o haz clic para seleccionar","uploader.imageLoaded":"✓ Imagen cargada correctamente","uploader.replaceImage":"Haz clic o arrastra una nueva imagen para reemplazar","uploader.processing":"Procesando imagen...","uploader.supportedFormats":"Formatos soportados: JPG, PNG, WEBP (m\xe1x.","uploader.firstUpload":"Primero sube una imagen de fondo","qslEditor.title":"Personalizar Tabla QSL","qslEditor.generate":"Generar Tabla QSL","qslEditor.generateDescription":"Personaliza los colores y genera tu tabla QSL","qslEditor.headerColor":"Color del encabezado:","qslEditor.bodyColor":"Color del cuerpo:","qslEditor.borderColor":"Color del borde:","qslEditor.textColor":"Color del texto:","qslEditor.borderWidth":"Grosor del borde:","qslEditor.language":"Idioma:","qslEditor.reset":"Restaurar","qslEditor.downloadSVG":"Descargar SVG","qslEditor.previewTitle":"Vista previa de la tabla QSL","qslEditor.clickToChange":"(Click para cambiar)","qsl.confirming":"CONFIRMANDO","qsl.qsoWith":"QSO A","qsl.date":"FECHA","qsl.day":"D\xcdA","qsl.month":"MES","qsl.year":"A\xd1O","qsl.utc":"UTC","qsl.mhz":"Mhz","qsl.rst":"RST","qsl.mode":"MOD","qsl.qsl":"QSL","download.button":"Descargar Tarjeta QSL (1650\xd71050)","download.processing":"Generando...","download.complete":"\xa1Descargado!","download.success":"✅ \xa1Tarjeta descargada exitosamente!","download.successSubtitle":"Tu tarjeta QSL est\xe1 lista para imprimir","download.createNew":"\uD83D\uDD04 Crear nueva tarjeta","download.completeSteps":"Completa los pasos anteriores para descargar","preview.title":"Vista previa de su tarjeta QSL","preview.rendering":"Renderizando...","preview.uploadFirst":"Suba una imagen de fondo para ver la vista previa","preview.scaledVersion":"Vista previa escalada - La descarga ser\xe1 en alta resoluci\xf3n (1650\xd71050px)","preview.finalPreview":"Vista previa final (como se exportar\xe1)","preview.imageEditor":"Editor de imagen","preview.backToEdit":"Volver a editar","preview.finalView":"Vista final","preview.reRender":"Re-renderizar vista previa","preview.exactResult":"Esta es la vista previa exacta de como se exportar\xe1 la tarjeta","preview.finalResult":"Resultado final","preview.dragInstructions":"Arrastra la imagen para mover, usa los handles para redimensionar y rotar","preview.followsBlueBox":"La imagen sigue exactamente al recuadro azul","preview.scale":"Escala","preview.rotation":"Rotaci\xf3n","preview.position":"Posici\xf3n","preview.size":"Tama\xf1o","language.toggle":"Cambiar idioma","language.current":"Espa\xf1ol","common.reset":"\uD83D\uDD04 Empezar de nuevo","upload.title":"Sube tu imagen de fondo","table.title":"Personaliza la tabla QSL","download.title":"Descargar tarjeta QSL","template.title":"Plantilla de Dise\xf1o","template.description":"Descarga una plantilla PNG para dise\xf1ar tu imagen de fondo con la referencia exacta de la tabla QSL","template.features":"Caracter\xedsticas de la plantilla","template.feature1":"Dimensiones exactas: 1650 \xd7 1050 px (300 DPI)","template.feature2":"Fondo blanco listo para dise\xf1ar","template.feature3":"L\xedneas punteadas que marcan el \xe1rea de la tabla QSL","template.feature4":"Marcadores de esquina para referencia precisa","template.download":"Descargar Plantilla PNG"},en:{"header.title":"\uD83C\uDFAF QSL Card Generator","header.subtitle":"Create professional QSL cards with custom background image and editable QSL table","header.createdBy":"Created by","instructions.title":"\uD83D\uDCCB How to use","instructions.step1":"Upload a high-quality image as background for your QSL card","instructions.step2":"Customize colors and language of the QSL table according to your preferences","instructions.step3":"See the real-time preview of your personalized QSL card","instructions.step4":"Download your QSL card in high resolution ready to print","tech.title":"⚙️ Technical Specifications","tech.resolution":"Final resolution:","tech.format":"Standard format:","tech.inputFormats":"Input formats:","tech.maxSize":"Maximum size:","tech.table":"QSL table:","tech.processing":"Processing:","tech.privacy":"\uD83D\uDD12 Privacy guaranteed: All images are processed locally in your browser, no data sent to external servers.","tech.dynamicGenerated":"Dynamically generated","tech.localProcessing":"100% local in your browser","tech.localHint":"✅ 100% processing local - Your images never leave your browser","steps.image":"Image","steps.table":"QSL Table","steps.preview":"Preview","steps.download":"Download","steps.current":"Current step:","steps.next":"Next:","step1.title":"Upload your background image","step2.title":"Customize QSL table","step3.title":"Card preview","step4.title":"Download QSL card","uploader.dragActive":"Drop the image here","uploader.dragInactive":"Upload your background image","uploader.subtitle":"Drag and drop, or click to select","uploader.imageLoaded":"✓ Image loaded successfully","uploader.replaceImage":"Click or drag a new image to replace","uploader.processing":"Processing image...","uploader.supportedFormats":"Supported formats: JPG, PNG, WEBP (max.","uploader.firstUpload":"First upload a background image","qslEditor.title":"Customize QSL Table","qslEditor.generate":"Generate QSL Table","qslEditor.generateDescription":"Customize colors and generate your QSL table","qslEditor.headerColor":"Header color:","qslEditor.bodyColor":"Body color:","qslEditor.borderColor":"Border color:","qslEditor.textColor":"Text color:","qslEditor.borderWidth":"Border width:","qslEditor.language":"Language:","qslEditor.reset":"Reset","qslEditor.downloadSVG":"Download SVG","qslEditor.previewTitle":"QSL table preview","qslEditor.clickToChange":"(Click to change)","qsl.confirming":"CONFIRMING","qsl.qsoWith":"QSO WITH","qsl.date":"DATE","qsl.day":"DAY","qsl.month":"MONTH","qsl.year":"YEAR","qsl.utc":"UTC","qsl.mhz":"Mhz","qsl.rst":"RST","qsl.mode":"MOD","qsl.qsl":"QSL","download.button":"Download QSL Card (1650\xd71050)","download.processing":"Generating...","download.complete":"Downloaded!","download.success":"✅ Card downloaded successfully!","download.successSubtitle":"Your QSL card is ready to print","download.createNew":"\uD83D\uDD04 Create new card","download.completeSteps":"Complete the previous steps to download","preview.title":"Preview of your QSL card","preview.rendering":"Rendering...","preview.uploadFirst":"Upload a background image to see the preview","preview.scaledVersion":"Scaled preview - Download will be in high resolution (1650\xd71050px)","preview.finalPreview":"Final preview (as it will be exported)","preview.imageEditor":"Image editor","preview.backToEdit":"Back to edit","preview.finalView":"Final view","preview.reRender":"Re-render preview","preview.exactResult":"This is the exact preview of how the card will be exported","preview.finalResult":"Final result","preview.dragInstructions":"Drag the image to move, use the handles to resize and rotate","preview.followsBlueBox":"The image follows exactly the blue box","preview.scale":"Scale","preview.rotation":"Rotation","preview.position":"Position","preview.size":"Size","language.toggle":"Change language","language.current":"English","common.reset":"\uD83D\uDD04 Start over","upload.title":"Upload your background image","table.title":"Customize QSL table","download.title":"Download QSL card","template.title":"Design Template","template.description":"Download a PNG template to design your background image with the exact QSL table reference","template.features":"Template features","template.feature1":"Exact dimensions: 1650 \xd7 1050 px (300 DPI)","template.feature2":"White background ready for design","template.feature3":"Dotted lines marking the QSL table area","template.feature4":"Corner markers for precise reference","template.download":"Download PNG Template"}},o=()=>navigator.language.toLowerCase().startsWith("es")?"es":"en",n=e=>{let{children:t}=e,[a,n]=(0,s.useState)("en"),[d,c]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{n(o()),c(!0)},[]),(0,r.jsx)(l.Provider,{value:{language:a,setLanguage:n,t:e=>d&&i[a][e]||e},children:t})},d=()=>{let e=(0,s.useContext)(l);if(void 0===e)throw Error("useLanguage must be used within a LanguageProvider");return e}},3796:(e,t,a)=>{"use strict";a.d(t,{As:()=>o,jb:()=>i,lF:()=>l,renderQSLCardExact:()=>n,zu:()=>s});var r=a(5844);let s=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1650,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1050;console.log("renderQSLCardWithTable: Starting render with:",{hasBackgroundImage:!!e,hasSvgTable:!!t,canvasSize:"".concat(a,"x").concat(s)});let l=document.createElement("canvas"),i=l.getContext("2d");if(!i)throw Error("Could not get canvas context");if(l.width=a,l.height=s,i.fillStyle="white",i.fillRect(0,0,a,s),e.width===a&&e.height===s)console.log("renderQSLCardWithTable: Perfect size match, no scaling"),i.drawImage(e,0,0,a,s);else{let t=Math.min(a/e.width,s/e.height),r=e.width*t,l=e.height*t,o=(a-r)/2,n=(s-l)/2;console.log("renderQSLCardWithTable: Scaling image with letterbox/pillarbox:",{originalSize:"".concat(e.width,"x").concat(e.height),scale:t,scaledSize:"".concat(r,"x").concat(l),offset:"".concat(o,", ").concat(n)}),i.drawImage(e,o,n,r,l)}if(t){console.log("renderQSLCardWithTable: Rendering SVG table...");try{let e=(0,r.getQSLTablePosition)(a,s);console.log("renderQSLCardWithTable: Table position:",e);let l=t.cloneNode(!0);l.setAttribute("width",e.width.toString()),l.setAttribute("height",e.height.toString());let o=await (0,r.svgToImage)(l);console.log("renderQSLCardWithTable: SVG converted to image successfully"),i.drawImage(o,e.x,e.y,e.width,e.height),console.log("renderQSLCardWithTable: Table drawn on canvas")}catch(e){console.error("Error rendering SVG table:",e)}}else console.log("renderQSLCardWithTable: No SVG table provided");return l},l=async function(e,t,a){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1650,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1050;console.log("renderQSLCardWithTransform: Starting render with:",{hasBackgroundImage:!!e,hasSvgTable:!!a,transform:t,canvasSize:"".concat(s,"x").concat(l)});let i=document.createElement("canvas"),o=i.getContext("2d");if(!o)throw Error("Could not get canvas context");i.width=s,i.height=l,o.fillStyle="white",o.fillRect(0,0,s,l),o.save();let n=s/800,d=l/510,c=t.x*n,h=t.y*d,g=t.width*n,x=t.height*d;if(o.translate(c+g/2,h+x/2),o.rotate(t.rotation*Math.PI/180),o.translate(-g/2,-x/2),o.drawImage(e,0,0,g,x),o.restore(),a){console.log("renderQSLCardWithTransform: Rendering SVG table...");try{let e=(0,r.getQSLTablePosition)(s,l);console.log("renderQSLCardWithTransform: Table position:",e);let t=a.cloneNode(!0);t.setAttribute("width",e.width.toString()),t.setAttribute("height",e.height.toString());let i=await (0,r.svgToImage)(t);console.log("renderQSLCardWithTransform: SVG converted to image successfully"),o.drawImage(i,e.x,e.y,e.width,e.height),console.log("renderQSLCardWithTransform: Table drawn on canvas")}catch(e){console.error("Error rendering SVG table:",e)}}else console.log("renderQSLCardWithTransform: No SVG table provided");return i},i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"qsl_card.png";e.toBlob(e=>{if(!e)return void console.error("Failed to create blob from canvas");let a=URL.createObjectURL(e),r=document.createElement("a");r.href=a,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a)},"image/png",1)},o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1650,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1050,a=document.createElement("canvas"),s=a.getContext("2d");if(!s)throw Error("Could not get canvas context");a.width=e,a.height=t,s.fillStyle="white",s.fillRect(0,0,e,t);let l=(0,r.getQSLTablePosition)(e,t);return s.strokeStyle="#000000",s.lineWidth=2,s.setLineDash([8,8]),s.strokeRect(l.x,l.y,l.width,l.height),s.setLineDash([]),s.fillStyle="#666666",s.font="24px Arial, sans-serif",s.textAlign="center",s.fillText("QSL TABLE AREA",l.x+l.width/2,l.y-20),s.strokeStyle="#000000",s.lineWidth=2,s.setLineDash([]),s.beginPath(),s.moveTo(l.x-30,l.y),s.lineTo(l.x,l.y),s.lineTo(l.x,l.y-30),s.stroke(),s.beginPath(),s.moveTo(l.x+l.width+30,l.y),s.lineTo(l.x+l.width,l.y),s.lineTo(l.x+l.width,l.y-30),s.stroke(),s.beginPath(),s.moveTo(l.x-30,l.y+l.height),s.lineTo(l.x,l.y+l.height),s.lineTo(l.x,l.y+l.height+30),s.stroke(),s.beginPath(),s.moveTo(l.x+l.width+30,l.y+l.height),s.lineTo(l.x+l.width,l.y+l.height),s.lineTo(l.x+l.width,l.y+l.height+30),s.stroke(),s.fillStyle="#999999",s.font="18px Arial, sans-serif",s.textAlign="left",s.fillText("QSL Card Template - 1650 \xd7 1050 px (300 DPI)",50,50),s.fillText("Design your background image around this template",50,80),s.fillText("The dotted area shows where the QSL table will be placed",50,110),a},n=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1650,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1050;console.log("renderQSLCardExact: Starting render with EXACT dimensions:",{hasBackgroundImage:!!e,hasSvgTable:!!t,imageSize:"".concat(e.width,"x").concat(e.height),canvasSize:"".concat(a,"x").concat(s)});let l=document.createElement("canvas"),i=l.getContext("2d");if(!i)throw Error("Could not get canvas context");if(l.width=a,l.height=s,i.fillStyle="white",i.fillRect(0,0,a,s),i.drawImage(e,0,0,a,s),console.log("renderQSLCardExact: Image drawn at exact size without scaling"),t){console.log("renderQSLCardExact: Rendering SVG table...");try{let e=(0,r.getQSLTablePosition)(a,s);console.log("renderQSLCardExact: Table position:",e);let l=t.cloneNode(!0);l.setAttribute("width",e.width.toString()),l.setAttribute("height",e.height.toString());let o=await (0,r.svgToImage)(l);console.log("renderQSLCardExact: SVG converted to image successfully"),i.drawImage(o,e.x,e.y,e.width,e.height),console.log("renderQSLCardExact: Table drawn on canvas")}catch(e){console.error("Error rendering SVG table:",e)}}else console.log("renderQSLCardExact: No SVG table provided");return l}},5844:(e,t,a)=>{"use strict";a.d(t,{getQSLTablePosition:()=>s,svgToImage:()=>r});let r=e=>new Promise((t,a)=>{try{console.log("svgToImage: Starting conversion...");let r=new XMLSerializer().serializeToString(e);console.log("svgToImage: SVG serialized, length:",r.length),console.log("svgToImage: SVG data preview:",r.substring(0,200)+"...");let s=new Blob([r],{type:"image/svg+xml;charset=utf-8"}),l=URL.createObjectURL(s);console.log("svgToImage: Blob URL created:",l);let i=new Image;i.onload=()=>{console.log("svgToImage: Image loaded successfully, dimensions:",i.width,"x",i.height),URL.revokeObjectURL(l),t(i)},i.onerror=e=>{console.error("svgToImage: Image load error:",e),URL.revokeObjectURL(l),a(Error("Failed to load SVG as image"))},i.src=l}catch(e){console.error("svgToImage: Exception during conversion:",e),a(e)}}),s=(e,t)=>{let a=Math.floor(.9*e),r=Math.floor(.25*a),s=Math.floor(.08*t);return{x:Math.floor((e-a)/2),y:t-r-s,width:a,height:r}}},8899:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>E});var r=a(5155),s=a(2115),l=a(6710),i=a(7213),o=a(9869),n=a(5339);let d={MAX_FILE_SIZE:0xa00000};var c=a(3775);let h=e=>{let{onImageUpload:t,isLoading:a=!1,error:h=null,hasImage:g=!1}=e,{t:x}=(0,c.o)(),m=(0,s.useCallback)(e=>{e.length>0&&t(e[0])},[t]),{getRootProps:u,getInputProps:b,isDragActive:p}=(0,l.VB)({onDrop:m,accept:{"image/jpeg":[".jpg",".jpeg"],"image/png":[".png"],"image/webp":[".webp"]},maxFiles:1,multiple:!1});return(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsxs)("div",{...u(),className:"\n          border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-all duration-200\n          ".concat(p?"border-blue-400 dark:border-blue-500 bg-blue-50 dark:bg-blue-900/50":"border-gray-300 dark:border-gray-600 hover:border-blue-400 dark:hover:border-blue-500 hover:bg-gray-50 dark:hover:bg-gray-700/50","\n          ").concat(a?"opacity-50 pointer-events-none":"","\n        "),children:[(0,r.jsx)("input",{...b()}),(0,r.jsxs)("div",{className:"space-y-4",children:[g?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(i.A,{className:"mx-auto h-12 w-12 text-green-500 dark:text-green-400"}),(0,r.jsx)("p",{className:"text-sm text-green-600 dark:text-green-400 font-medium",children:"✓ Imagen cargada correctamente"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Haz clic o arrastra una nueva imagen para reemplazar"})]}):(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(o.A,{className:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-lg font-medium text-gray-700 dark:text-gray-300",children:p?"Suelta la imagen aqu\xed...":"Sube tu imagen de fondo"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Arrastra y suelta o haz clic para seleccionar"})]})]}),a&&(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 dark:border-blue-400"}),(0,r.jsx)("span",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Procesando imagen..."})]})]})]}),(0,r.jsx)("div",{className:"mt-4 text-center",children:(0,r.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Formatos soportados: JPG, PNG, WEBP (m\xe1x. ",d.MAX_FILE_SIZE/1024/1024,"MB)"]})}),h&&(0,r.jsx)("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-700 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(n.A,{className:"h-4 w-4 text-red-500 dark:text-red-400"}),(0,r.jsx)("p",{className:"text-sm text-red-700 dark:text-red-300",children:h})]})})]})};var g=a(133),x=a(2657),m=a(2568),u=a(4481),b=a(6262),p=a(3904),w=a(3796);let f=e=>{let{backgroundImage:t,qslTableSvg:l,imageTransform:i=null,onTransformChange:o,className:n=""}=e,{t:d}=(0,c.o)();(0,s.useEffect)(()=>{console.log("CardPreview: Props received:",{hasBackgroundImage:!!t,hasQslTableSvg:!!l,hasImageTransform:!!i,qslTableSvgDetails:l?{tagName:l.tagName,outerHTML:l.outerHTML.substring(0,200)+"..."}:null})},[t,l,i]);let h=(0,s.useRef)(null),f=(0,s.useRef)(null),[y,v]=(0,s.useState)(!1),[j,k]=(0,s.useState)(!1),N=(0,s.useCallback)(e=>{if(1650===e.width&&1050===e.height){let t=Math.min(800/e.width,510/e.height),a=e.width*t,r=e.height*t;return{x:(800-a)/2,y:(510-r)/2,width:a,height:r,rotation:0,scale:t}}{let t=Math.min(640/e.width,408/e.height),a=e.width*t,r=e.height*t;return{x:(800-a)/2,y:(510-r)/2,width:a,height:r,rotation:0,scale:t}}},[]),[S,C]=(0,s.useState)(()=>i||(t?N(t):{x:80,y:51,width:640,height:408,rotation:0,scale:1})),[L,T]=(0,s.useState)(!1),[E,q]=(0,s.useState)(!1),[Q,P]=(0,s.useState)({x:0,y:0}),[M,z]=(0,s.useState)(null),[I,W]=(0,s.useState)(null);(0,s.useEffect)(()=>{if(t&&!i){let e=N(t);C(e),o&&o(e)}else i&&C(i)},[t,i,N,o]);let R=(0,s.useCallback)(e=>{e.save();let t=S.x+S.width/2,a=S.y+S.height/2;e.translate(t,a),e.rotate(S.rotation*Math.PI/180),e.translate(-S.width/2,-S.height/2),e.strokeStyle="#3b82f6",e.lineWidth=2,e.setLineDash([5,5]),e.strokeRect(0,0,S.width,S.height),e.restore()},[S]),A=(0,s.useCallback)(e=>{if(L||E)return;let t=S.x+S.width/2,a=S.y+S.height/2,r=S.width/2,s=S.height/2,l=S.rotation*Math.PI/180,i=Math.cos(l),o=Math.sin(l),n=(e,r)=>({x:t+(e*i-r*o),y:a+(e*o+r*i)}),d=[{id:"nw",...n(-r,-s)},{id:"ne",...n(r,-s)},{id:"sw",...n(-r,s)},{id:"se",...n(r,s)},{id:"n",...n(0,-s)},{id:"s",...n(0,s)},{id:"w",...n(-r,0)},{id:"e",...n(r,0)}];e.fillStyle="#3b82f6",e.strokeStyle="#ffffff",e.lineWidth=2,e.setLineDash([]),d.forEach(t=>{e.fillRect(t.x-6,t.y-6,12,12),e.strokeRect(t.x-6,t.y-6,12,12)})},[L,E,S]),G=(0,s.useCallback)(async()=>{let e=h.current;if(!e||!t||j)return;let r=e.getContext("2d");if(!r)return;console.log("renderEditor: Starting render with:",{hasBackgroundImage:!!t,hasQslTableSvg:!!l,showFinalPreview:j}),r.clearRect(0,0,800,510);for(let e=0;e<800;e+=20)for(let t=0;t<510;t+=20)r.fillStyle=(e+t)/20%2==0?"#f0f0f0":"#e0e0e0",r.fillRect(e,t,20,20);r.save();let s=S.x+S.width/2,i=S.y+S.height/2;if(r.translate(s,i),r.rotate(S.rotation*Math.PI/180),r.translate(-S.width/2,-S.height/2),r.drawImage(t,0,0,S.width,S.height),r.restore(),R(r),A(r),l){console.log("renderEditor: Drawing QSL table overlay...");try{let{getQSLTablePosition:e}=await Promise.resolve().then(a.bind(a,5844)),t=e(800,510),s=l.cloneNode(!0);s.setAttribute("width",t.width.toString()),s.setAttribute("height",t.height.toString());let{svgToImage:i}=await Promise.resolve().then(a.bind(a,5844)),o=await i(s);r.drawImage(o,t.x,t.y,t.width,t.height),console.log("renderEditor: QSL table drawn successfully")}catch(e){console.error("renderEditor: Error drawing QSL table:",e)}}},[t,S,j,l,R,A]),D=(0,s.useCallback)(()=>{let e=S.x+S.width/2,t=S.y+S.height/2,a=S.width/2,r=S.height/2,s=S.rotation*Math.PI/180,l=Math.cos(s),i=Math.sin(s),o=(a,r)=>({x:e+(a*l-r*i),y:t+(a*i+r*l)});return[{id:"nw",...o(-a,-r)},{id:"ne",...o(a,-r)},{id:"sw",...o(-a,r)},{id:"se",...o(a,r)},{id:"n",...o(0,-r)},{id:"s",...o(0,r)},{id:"w",...o(-a,0)},{id:"e",...o(a,0)}]},[S]),F=(0,s.useCallback)((e,t)=>{let a=S.x+S.width/2,r=S.y+S.height/2,s=-S.rotation*Math.PI/180,l=Math.cos(s),i=Math.sin(s),o=e-a,n=t-r;return Math.abs(o*l-n*i)<=S.width/2&&Math.abs(o*i+n*l)<=S.height/2},[S]),V=(0,s.useCallback)(e=>{if(j)return;let t=h.current;if(!t)return;let a=t.getBoundingClientRect(),r=e.clientX-a.left,s=e.clientY-a.top,l=D().find(e=>12>Math.abs(r-e.x)&&12>Math.abs(s-e.y));l?(q(!0),z(l.id),W({...S})):F(r,s)&&(T(!0),W({...S})),P({x:r,y:s})},[j,D,F,S]),B=(0,s.useCallback)(e=>{if(j||!L&&!E)return;let t=h.current;if(!t||!I)return;let a=t.getBoundingClientRect(),r=e.clientX-a.left,s=e.clientY-a.top,l=r-Q.x,i=s-Q.y;L?C(e=>({...e,x:I.x+l,y:I.y+i})):E&&M&&U(l,i)},[j,L,E,Q,I,M]),U=(0,s.useCallback)((e,a)=>{if(!M||!I)return;let r={...I};switch(M){case"nw":r.width=Math.max(50,I.width-e),r.height=Math.max(50,I.height-a),r.x=I.x+e,r.y=I.y+a;break;case"ne":r.width=Math.max(50,I.width+e),r.height=Math.max(50,I.height-a),r.y=I.y+a;break;case"sw":r.width=Math.max(50,I.width-e),r.height=Math.max(50,I.height+a),r.x=I.x+e;break;case"se":r.width=Math.max(50,I.width+e),r.height=Math.max(50,I.height+a);break;case"n":r.height=Math.max(50,I.height-a),r.y=I.y+a;break;case"s":r.height=Math.max(50,I.height+a);break;case"w":r.width=Math.max(50,I.width-e),r.x=I.x+e;break;case"e":r.width=Math.max(50,I.width+e)}t&&(r.scale=Math.max(r.width/t.width,r.height/t.height)),C(r)},[M,I,t]),O=(0,s.useCallback)(()=>{(L||E)&&o&&o(S),T(!1),q(!1),z(null),W(null)},[L,E,S,o]),_=(0,s.useCallback)(e=>{let t={...S,rotation:S.rotation+e};C(t),o&&o(t)},[S,o]),H=(0,s.useCallback)(e=>{let t={...S,width:S.width*e,height:S.height*e,scale:S.scale*e};C(t),o&&o(t)},[S,o]),X=(0,s.useCallback)(()=>{if(!t)return;let e=N(t);C(e),o&&o(e)},[t,N,o]),Y=(0,s.useCallback)(async()=>{if(f.current&&t){v(!0);try{let e,r=f.current;if(r.width=1650,r.height=1050,console.log("Rendering final preview with:",{hasBackgroundImage:!!t,hasQslTable:!!l,imageSize:"".concat(t.width,"x").concat(t.height),transform:S}),1650===t.width&&1050===t.height){console.log("Template detected - using exact rendering without scaling");let{renderQSLCardExact:r}=await Promise.resolve().then(a.bind(a,3796));e=await r(t,l||void 0,1650,1050)}else{let a=N(t),r=Math.abs(S.x-a.x)>5||Math.abs(S.y-a.y)>5||Math.abs(S.rotation)>.1||Math.abs(S.width-a.width)>5||Math.abs(S.height-a.height)>5;console.log("Transform comparison:",{current:S,initial:a,hasSignificantChanges:r}),r?(console.log("Using renderQSLCardWithTransform"),e=await (0,w.lF)(t,S,l||void 0,1650,1050)):(console.log("Using renderQSLCardWithTable (with improved scaling)"),e=await (0,w.zu)(t,l||void 0,1650,1050))}let s=r.getContext("2d");s&&e?(s.clearRect(0,0,1650,1050),s.drawImage(e,0,0),console.log("Final preview rendered successfully")):console.error("Failed to get context or rendered canvas")}catch(e){console.error("Error rendering final preview:",e)}finally{v(!1)}}},[t,l,S,N]);(0,s.useEffect)(()=>{j&&Y()},[j,Y]),(0,s.useEffect)(()=>{j||G()},[G,j]);let J=(0,s.useCallback)(()=>{k(!j)},[j]);return t?(0,r.jsx)("div",{className:"text-center ".concat(n),children:(0,r.jsxs)("div",{className:"inline-block p-4 bg-white dark:bg-gray-800 rounded-lg shadow-lg border dark:border-gray-600 relative",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:d(j?"preview.finalPreview":"preview.imageEditor")}),(0,r.jsx)("button",{onClick:J,className:"px-3 py-1 text-white text-sm rounded transition-colors flex items-center gap-1 ".concat(j?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700"),children:j?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.A,{size:14}),d("preview.backToEdit")]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.A,{size:14}),d("preview.finalView")]})})]}),y&&(0,r.jsx)("div",{className:"absolute inset-0 bg-white dark:bg-gray-800 bg-opacity-75 dark:bg-opacity-75 flex items-center justify-center rounded-lg z-10",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-blue-600 dark:border-blue-400 border-t-transparent rounded-full animate-spin"}),(0,r.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:d("preview.rendering")})]})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"relative inline-block",children:[(0,r.jsx)("canvas",{ref:h,width:800,height:510,className:"border border-gray-200 dark:border-gray-600 rounded cursor-move ".concat(j?"hidden":""),style:{maxWidth:"100%",height:"auto"},onMouseDown:V,onMouseMove:B,onMouseUp:O,onMouseLeave:O}),(0,r.jsx)("canvas",{ref:f,className:"border border-gray-200 dark:border-gray-600 rounded ".concat(j?"":"hidden"),style:{maxWidth:"100%",height:"auto"}})]}),!j&&(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 justify-center",children:[(0,r.jsxs)("button",{onClick:()=>_(-15),className:"flex items-center gap-1 px-3 py-2 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 rounded text-sm transition-colors",children:[(0,r.jsx)(g.A,{size:16}),"-15\xb0"]}),(0,r.jsxs)("button",{onClick:()=>_(15),className:"flex items-center gap-1 px-3 py-2 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 rounded text-sm transition-colors",children:[(0,r.jsx)(m.A,{size:16}),"+15\xb0"]}),(0,r.jsxs)("button",{onClick:()=>H(1.1),className:"flex items-center gap-1 px-3 py-2 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 rounded text-sm transition-colors",children:[(0,r.jsx)(u.A,{size:16}),"110%"]}),(0,r.jsxs)("button",{onClick:()=>H(.9),className:"flex items-center gap-1 px-3 py-2 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 rounded text-sm transition-colors",children:[(0,r.jsx)(b.A,{size:16}),"90%"]}),(0,r.jsxs)("button",{onClick:X,className:"flex items-center gap-1 px-3 py-2 bg-red-100 hover:bg-red-200 dark:bg-red-900 dark:hover:bg-red-800 text-red-700 dark:text-red-300 rounded text-sm transition-colors",children:[(0,r.jsx)(g.A,{size:16}),d("qslEditor.reset")]})]}),j&&(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsxs)("button",{onClick:Y,disabled:y,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded transition-colors",children:[(0,r.jsx)(p.A,{size:16,className:y?"animate-spin":""}),d(y?"preview.rendering":"preview.reRender")]})}),!j&&(0,r.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 space-y-1",children:[(0,r.jsxs)("div",{children:[d("preview.scale"),": ",(100*S.scale).toFixed(1),"%"]}),(0,r.jsxs)("div",{children:[d("preview.rotation"),": ",S.rotation.toFixed(1),"\xb0"]}),(0,r.jsxs)("div",{children:[d("preview.position"),": (",Math.round(S.x),", ",Math.round(S.y),")"]}),(0,r.jsxs)("div",{children:[d("preview.size"),": ",Math.round(S.width)," \xd7 ",Math.round(S.height)]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:j?(0,r.jsxs)(r.Fragment,{children:[d("preview.exactResult"),(0,r.jsx)("br",{}),(0,r.jsxs)("span",{className:"text-green-600 dark:text-green-400",children:["✓ ",d("preview.finalResult")," - ",d("download.button")]})]}):(0,r.jsxs)(r.Fragment,{children:[d("preview.dragInstructions"),(0,r.jsx)("br",{}),(0,r.jsx)("span",{className:"text-blue-600 dark:text-blue-400",children:d("preview.followsBlueBox")})]})})]})]})}):(0,r.jsx)("div",{className:"text-center p-8 ".concat(n),children:(0,r.jsx)("div",{className:"w-full h-64 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center",children:(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:d("preview.uploadFirst")})})})};var y=a(5196),v=a(1788);let j=e=>{let{onDownload:t,isProcessing:a=!1,disabled:l=!1,text:i}=e,{t:o}=(0,c.o)(),[n,d]=(0,s.useState)(!1),h=async()=>{if(!l&&!a)try{await t(),d(!0),setTimeout(()=>d(!1),3e3)}catch(e){console.error("Error al descargar:",e)}},g=l||a,x=i||o("download.button");return(0,r.jsx)("button",{onClick:h,disabled:g,className:"\n        w-full flex items-center justify-center space-x-2 px-6 py-3 rounded-lg font-medium transition-all duration-200\n        ".concat(g?"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed":n?"bg-green-500 dark:bg-green-600 text-white hover:bg-green-600 dark:hover:bg-green-700 shadow-lg":"bg-green-600 dark:bg-green-500 text-white hover:bg-green-700 dark:hover:bg-green-600 hover:shadow-lg shadow-green-500/30 transform hover:-translate-y-0.5 animate-pulse","\n      "),children:a?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),(0,r.jsx)("span",{children:o("download.processing")})]}):n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(y.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:o("download.complete")})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(v.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:x})]})})};var k=a(3127);let N={headerColor:"#B8860B",bodyColor:"#FFFFFF",borderColor:"#000000",textColor:"#000000",borderWidth:2,language:"en"},S=e=>{let{onTableGenerated:t,config:a}=e,{language:l,t:i}=(0,c.o)(),[o,n]=(0,s.useState)(a||N),[d,h]=(0,s.useState)(!1),[x,m]=(0,s.useState)(!1),u=(0,s.useRef)(null);(0,s.useEffect)(()=>{h(!0)},[]),(0,s.useEffect)(()=>{d&&n(e=>({...e,language:l}))},[l,d]);let b=()=>{if(!u.current||!d)return void console.log("generateSVG: Cannot generate - svgRef:",!!u.current,"mounted:",d);console.log("generateSVG: Generating SVG table...");let e=u.current.cloneNode(!0);console.log("generateSVG: SVG cloned successfully, calling onTableGenerated"),m(!0),t(e)};(0,s.useEffect)(()=>{d&&x&&b()},[o,d,x]);let p=(e,t)=>{n(a=>({...a,[e]:t}))};return d?(0,r.jsxs)("div",{className:"w-full space-y-6",children:[!x&&(0,r.jsx)("div",{className:"text-center p-8 bg-gray-50 dark:bg-gray-700 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center mx-auto",children:(0,r.jsx)(k.A,{className:"h-8 w-8 text-blue-600 dark:text-blue-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-2",children:i("qslEditor.title")}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-4",children:i("qslEditor.generateDescription")}),(0,r.jsxs)("button",{onClick:b,className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white rounded-lg font-medium transition-colors flex items-center gap-2 mx-auto",children:[(0,r.jsx)(k.A,{className:"h-5 w-5"}),i("qslEditor.generate")]})]})]})}),x&&(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700 block",children:i("qslEditor.headerColor")}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("input",{type:"color",value:o.headerColor,onChange:e=>p("headerColor",e.target.value),className:"w-16 h-10 rounded border border-gray-300 cursor-pointer"}),(0,r.jsx)("span",{className:"text-sm text-gray-600 font-mono",children:o.headerColor})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700 block",children:i("qslEditor.bodyColor")}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("input",{type:"color",value:o.bodyColor,onChange:e=>p("bodyColor",e.target.value),className:"w-16 h-10 rounded border border-gray-300 cursor-pointer"}),(0,r.jsx)("span",{className:"text-sm text-gray-600 font-mono",children:o.bodyColor})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700 block",children:i("qslEditor.borderColor")}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("input",{type:"color",value:o.borderColor,onChange:e=>p("borderColor",e.target.value),className:"w-16 h-10 rounded border border-gray-300 cursor-pointer"}),(0,r.jsx)("span",{className:"text-sm text-gray-600 font-mono",children:o.borderColor})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700 block",children:i("qslEditor.textColor")}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("input",{type:"color",value:o.textColor,onChange:e=>p("textColor",e.target.value),className:"w-16 h-10 rounded border border-gray-300 cursor-pointer"}),(0,r.jsx)("span",{className:"text-sm text-gray-600 font-mono",children:o.textColor})]})]})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 gap-6",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700 block",children:i("qslEditor.borderWidth")}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("input",{type:"range",min:"1",max:"5",value:o.borderWidth,onChange:e=>p("borderWidth",parseInt(e.target.value)),className:"flex-1"}),(0,r.jsxs)("span",{className:"text-sm text-gray-600 font-mono min-w-[40px]",children:[o.borderWidth,"px"]})]})]})})]}),(0,r.jsxs)("div",{className:"flex gap-3 mt-8 pt-6 border-t border-gray-200",children:[(0,r.jsxs)("button",{onClick:()=>{n({...N,language:l})},className:"flex items-center gap-2 px-4 py-2 text-sm bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:[(0,r.jsx)(g.A,{className:"h-4 w-4"}),i("qslEditor.reset")]}),(0,r.jsxs)("button",{onClick:()=>{if(!u.current)return;let e=new Blob([new XMLSerializer().serializeToString(u.current)],{type:"image/svg+xml;charset=utf-8"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="tabla_qsl.svg",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t)},className:"flex items-center gap-2 px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,r.jsx)(v.A,{className:"h-4 w-4"}),i("qslEditor.downloadSVG")]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-lg border ".concat(x?"":"hidden"),children:[(0,r.jsx)("h4",{className:"text-lg font-medium text-gray-700 mb-4 text-center",children:i("qslEditor.previewTitle")}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsxs)("svg",{ref:u,width:"1000",height:"250",viewBox:"-10 -10 920 220",xmlns:"http://www.w3.org/2000/svg",className:"rounded shadow-sm max-w-full",children:[(0,r.jsx)("defs",{children:(0,r.jsx)("style",{children:"\n                  .header-text { \n                    font-family: Arial, sans-serif; \n                    font-size: 14px; \n                    font-weight: bold; \n                    text-anchor: middle; \n                    dominant-baseline: middle;\n                  }\n                  .sub-header-text { \n                    font-family: Arial, sans-serif; \n                    font-size: 11px; \n                    font-weight: bold; \n                    text-anchor: middle; \n                    dominant-baseline: middle;\n                  }\n                  .long-text {\n                    font-family: Arial, sans-serif; \n                    font-size: 12px; \n                    font-weight: bold; \n                    text-anchor: middle; \n                    dominant-baseline: middle;\n                  }\n                "})}),(0,r.jsx)("rect",{x:"0",y:"0",width:"900",height:"90",fill:o.headerColor,stroke:o.borderColor,strokeWidth:o.borderWidth}),(0,r.jsx)("rect",{x:"0",y:"90",width:"900",height:"110",fill:o.bodyColor,stroke:o.borderColor,strokeWidth:o.borderWidth}),(0,r.jsx)("line",{x1:"120",y1:"0",x2:"120",y2:"200",stroke:o.borderColor,strokeWidth:o.borderWidth}),(0,r.jsx)("line",{x1:"270",y1:"0",x2:"270",y2:"200",stroke:o.borderColor,strokeWidth:o.borderWidth}),(0,r.jsx)("line",{x1:"420",y1:"0",x2:"420",y2:"200",stroke:o.borderColor,strokeWidth:o.borderWidth}),(0,r.jsx)("line",{x1:"540",y1:"0",x2:"540",y2:"200",stroke:o.borderColor,strokeWidth:o.borderWidth}),(0,r.jsx)("line",{x1:"660",y1:"0",x2:"660",y2:"200",stroke:o.borderColor,strokeWidth:o.borderWidth}),(0,r.jsx)("line",{x1:"780",y1:"0",x2:"780",y2:"200",stroke:o.borderColor,strokeWidth:o.borderWidth}),(0,r.jsx)("line",{x1:"0",y1:"90",x2:"900",y2:"90",stroke:o.borderColor,strokeWidth:o.borderWidth}),(0,r.jsx)("line",{x1:"120",y1:"45",x2:"270",y2:"45",stroke:o.borderColor,strokeWidth:o.borderWidth}),(0,r.jsx)("line",{x1:"170",y1:"45",x2:"170",y2:"90",stroke:o.borderColor,strokeWidth:o.borderWidth}),(0,r.jsx)("line",{x1:"220",y1:"45",x2:"220",y2:"90",stroke:o.borderColor,strokeWidth:o.borderWidth}),(0,r.jsx)("text",{x:"60",y:"45",className:"long-text",fill:o.textColor,children:i("qsl.confirming")}),(0,r.jsx)("text",{x:"195",y:"22",className:"header-text",fill:o.textColor,children:i("qsl.date")}),(0,r.jsx)("text",{x:"345",y:"45",className:"header-text",fill:o.textColor,children:i("qsl.utc")}),(0,r.jsx)("text",{x:"480",y:"45",className:"header-text",fill:o.textColor,children:i("qsl.mhz")}),(0,r.jsx)("text",{x:"600",y:"45",className:"header-text",fill:o.textColor,children:i("qsl.rst")}),(0,r.jsx)("text",{x:"720",y:"45",className:"header-text",fill:o.textColor,children:i("qsl.mode")}),(0,r.jsx)("text",{x:"840",y:"45",className:"header-text",fill:o.textColor,children:i("qsl.qsl")}),(0,r.jsx)("text",{x:"60",y:"67",className:"long-text",fill:o.textColor,children:i("qsl.qsoWith")}),(0,r.jsx)("text",{x:"145",y:"67",className:"sub-header-text",fill:o.textColor,children:i("qsl.day")}),(0,r.jsx)("text",{x:"195",y:"67",className:"sub-header-text",fill:o.textColor,children:i("qsl.month")}),(0,r.jsx)("text",{x:"245",y:"67",className:"sub-header-text",fill:o.textColor,children:i("qsl.year")}),(0,r.jsx)("rect",{x:"0",y:"0",width:"900",height:"200",fill:"none",stroke:o.borderColor,strokeWidth:o.borderWidth})]})})]})]}):(0,r.jsx)("div",{className:"h-64 bg-gray-100 animate-pulse rounded-lg"})},C=()=>{let[e,t]=(0,s.useState)({isProcessing:!1,error:null}),a=async(e,a,r)=>{t({isProcessing:!0,error:null});try{let s,l=1650===e.width&&1050===e.height;return console.log("useImageProcessor: generateFinalCanvas",{imageSize:"".concat(e.width,"x").concat(e.height),isTemplate:l,hasTransform:!!r,hasQslTable:!!a}),l?(console.log("Template detected - using exact rendering without scaling"),s=await (0,w.renderQSLCardExact)(e,a||void 0,1650,1050)):r?(console.log("Using transform-based rendering"),s=await (0,w.lF)(e,r,a||void 0,1650,1050)):(console.log("Using default rendering with improved scaling"),s=await (0,w.zu)(e,a||void 0,1650,1050)),t({isProcessing:!1,error:null}),s}catch(e){throw t({isProcessing:!1,error:e instanceof Error?e.message:"Error desconocido"}),e}},r=async function(e,t,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"tarjeta_qsl.png";try{let l=await a(e,t,r);(0,w.jb)(l,s)}catch(e){throw console.error("Error al descargar la tarjeta QSL:",e),e}};return{...e,generateFinalCanvas:a,downloadQSLCard:r}},L=e=>e.size>0xa00000?{isValid:!1,error:"El archivo es demasiado grande. M\xe1ximo ".concat(10,"MB permitidos.")}:["image/jpeg","image/jpg","image/png","image/webp"].includes(e.type)?{isValid:!0}:{isValid:!1,error:"Formato no soportado. Solo se permiten JPG, PNG y WEBP."},T=e=>new Promise((t,a)=>{let r=new FileReader;r.onload=e=>{var r;let s=new Image;s.onload=()=>t(s),s.onerror=a,s.src=null==(r=e.target)?void 0:r.result},r.onerror=a,r.readAsDataURL(e)});function E(){let{t:e}=(0,c.o)(),[t,a]=(0,s.useState)(null),[l,i]=(0,s.useState)(null),[o,n]=(0,s.useState)(null),[d,g]=(0,s.useState)(!1),[x,m]=(0,s.useState)(null),[u,b]=(0,s.useState)(1),{isProcessing:p,error:y,downloadQSLCard:k}=C();(0,s.useEffect)(()=>{t&&1===u&&b(2)},[t,u]);let N=async e=>{g(!0),m(null);try{let t=L(e);if(!t.isValid)throw Error(t.error);let r=await T(e);a(r),i(null)}catch(e){m(e instanceof Error?e.message:"Error al procesar la imagen")}finally{g(!1)}},E=async()=>{if(t)try{await k(t,o,l),b(4)}catch(e){console.error("Error al descargar:",e)}};return(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"text-center mb-12",children:[(0,r.jsx)("h1",{className:"text-4xl md:text-5xl font-bold text-gray-800 dark:text-white mb-4",children:e("header.title")}),(0,r.jsx)("p",{className:"text-xl text-gray-600 dark:text-gray-300 mb-6 max-w-3xl mx-auto",children:e("header.subtitle")}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e("header.createdBy")," ",(0,r.jsx)("span",{className:"text-blue-600 dark:text-blue-400 font-semibold",children:"LU9ANG"})," • ",(0,r.jsx)("a",{href:"https://github.com/alvarongg",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-semibold transition-colors",children:"@alvarongg"})]})]}),(0,r.jsx)("div",{className:"max-w-7xl mx-auto mb-8",children:(0,r.jsxs)("div",{className:"grid md:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-4 flex items-center gap-2",children:["\uD83D\uDCCB ",e("instructions.title")]}),(0,r.jsxs)("ul",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-300",children:[(0,r.jsxs)("li",{className:"flex items-start space-x-2",children:[(0,r.jsx)("span",{className:"flex-shrink-0 w-5 h-5 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs font-bold",children:"1"}),(0,r.jsx)("span",{children:e("instructions.step1")})]}),(0,r.jsxs)("li",{className:"flex items-start space-x-2",children:[(0,r.jsx)("span",{className:"flex-shrink-0 w-5 h-5 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs font-bold",children:"2"}),(0,r.jsx)("span",{children:e("instructions.step2")})]}),(0,r.jsxs)("li",{className:"flex items-start space-x-2",children:[(0,r.jsx)("span",{className:"flex-shrink-0 w-5 h-5 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs font-bold",children:"3"}),(0,r.jsx)("span",{children:e("instructions.step3")})]}),(0,r.jsxs)("li",{className:"flex items-start space-x-2",children:[(0,r.jsx)("span",{className:"flex-shrink-0 w-5 h-5 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs font-bold",children:"4"}),(0,r.jsx)("span",{children:e("instructions.step4")})]})]})]}),(0,r.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:(0,r.jsxs)("div",{className:"text-center space-y-3",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center mx-auto",children:(0,r.jsx)(v.A,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:e("template.title")}),(0,r.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-300",children:e("template.description")}),(0,r.jsxs)("button",{onClick:()=>{try{let e=(0,w.As)();(0,w.jb)(e,"qsl_template.png")}catch(e){console.error("Error generating template:",e)}},className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white rounded-lg text-sm font-medium transition-colors",children:[(0,r.jsx)(v.A,{className:"h-4 w-4"}),e("template.download")]})]})}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-4 flex items-center gap-2",children:["⚙️ ",e("tech.title")]}),(0,r.jsxs)("div",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-300",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:e("tech.resolution")}),(0,r.jsx)("span",{className:"font-semibold",children:"1650 \xd7 1050 px"})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:e("tech.format")}),(0,r.jsx)("span",{className:"font-semibold",children:'5.5" \xd7 3.5"'})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:e("tech.inputFormats")}),(0,r.jsx)("span",{className:"font-semibold",children:"JPG, PNG, WEBP"})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:e("tech.maxSize")}),(0,r.jsx)("span",{className:"font-semibold",children:"10MB"})]})]}),(0,r.jsx)("div",{className:"mt-4 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:(0,r.jsx)("p",{className:"text-xs text-green-700 dark:text-green-300 font-medium",children:e("tech.localHint")})})]})]})}),(0,r.jsxs)("div",{className:"max-w-2xl mx-auto mb-8",children:[(0,r.jsx)("div",{className:"flex justify-center items-center space-x-4",children:[1,2,3,4].map(e=>(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"\n                  w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-all\n                  ".concat(u>=e?4===e&&4===u&&t&&o?"bg-green-600 dark:bg-green-500 text-white shadow-lg shadow-green-500/30 animate-pulse":"bg-blue-600 dark:bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400","\n                "),children:e}),e<4&&(0,r.jsx)("div",{className:"\n                    w-8 h-1 mx-2 transition-all\n                    ".concat(u>e?"bg-blue-600 dark:bg-blue-500":"bg-gray-200 dark:bg-gray-700","\n                  ")})]},e))}),(0,r.jsx)("div",{className:"text-center mt-4",children:(0,r.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:u<=4&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"font-medium",children:e("steps.current")}),(0,r.jsxs)("span",{className:"ml-1",children:[1===u&&e("steps.image"),2===u&&e("steps.table"),3===u&&e("steps.preview"),4===u&&e("steps.download")]}),u<4&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"mx-2",children:"•"}),(0,r.jsx)("span",{className:"font-medium",children:e("steps.next")}),(0,r.jsxs)("span",{className:"ml-1",children:[1===u&&e("steps.table"),2===u&&e("steps.preview"),3===u&&e("steps.download")]})]})]})})})]}),(0,r.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,r.jsxs)("div",{className:"grid lg:grid-cols-2 gap-8",children:[(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsx)("div",{className:"transition-all ".concat(u>=1?"opacity-100":"opacity-50"),children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-blue-600 dark:bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"1"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:e("upload.title")})]}),(0,r.jsx)(h,{onImageUpload:N,isLoading:d,error:x,hasImage:!!t})]})}),(0,r.jsx)("div",{className:"transition-all ".concat(u>=2?"opacity-100":"opacity-50"),children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-blue-600 dark:bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"2"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:e("table.title")})]}),(0,r.jsx)(S,{onTableGenerated:e=>{console.log("handleTableGenerated: Received SVG table:",e),console.log("handleTableGenerated: SVG outerHTML:",e.outerHTML.substring(0,200)+"..."),n(e),b(3)}})]})})]}),(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsx)("div",{className:"transition-all ".concat(t?"opacity-100":"opacity-50"),children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-blue-600 dark:bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"3"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:e("preview.title")})]}),(0,r.jsx)(f,{backgroundImage:t,qslTableSvg:o,imageTransform:l,onTransformChange:e=>{i(e)}})]})}),(0,r.jsx)("div",{className:"transition-all ".concat(u>=4?"opacity-100":"opacity-50"),children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 ".concat(4===u&&t&&o?"ring-2 ring-green-500 ring-opacity-50 shadow-green-500/20":""),children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-all ".concat(4===u&&t&&o?"bg-green-600 dark:bg-green-500 text-white shadow-lg shadow-green-500/30 animate-pulse":"bg-blue-600 dark:bg-blue-500 text-white"),children:"4"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:e("download.title")})]}),(0,r.jsx)(j,{onDownload:E,isProcessing:p,disabled:!t||!o}),y&&(0,r.jsx)("div",{className:"mt-4 p-3 bg-red-100 dark:bg-red-900 border border-red-300 dark:border-red-700 rounded text-red-700 dark:text-red-300 text-sm",children:y})]})})]})]})}),t&&(0,r.jsx)("div",{className:"max-w-4xl mx-auto mt-8 text-center",children:(0,r.jsx)("button",{onClick:()=>{a(null),i(null),n(null),m(null),b(1)},className:"px-6 py-3 bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-600 text-white rounded-lg font-medium transition-colors",children:e("common.reset")})})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[355,441,684,358],()=>t(3496)),_N_E=e.O()}]);